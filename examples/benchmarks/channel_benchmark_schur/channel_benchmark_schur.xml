<Param>
    <OutputPrefix>ChannelBenchmark</OutputPrefix>
    <Mesh>
        <Filename1>dfg2d_rect.inp</Filename1>
        <Filename2>dfg_bench3d_rect2.inp</Filename2>
        <InitialRefLevel>2</InitialRefLevel>
    </Mesh>
    <UseBoundaryDomainDescriptor>0</UseBoundaryDomainDescriptor>
    <FlowModel>
        <Density>1.0</Density>
        <Viscosity>1.0e-3</Viscosity>
        <InflowSpeed>2.25</InflowSpeed>
        <InflowHeight>0.41</InflowHeight>
        <InflowWidth>0.41</InflowWidth>
    </FlowModel>
    <DFGbenchmark>0</DFGbenchmark>
    <BenchQuantities>0</BenchQuantities>
    <QuadratureOrder>6</QuadratureOrder>
    <FiniteElements>
        <VelocityDegree>2</VelocityDegree>
        <PressureDegree>1</PressureDegree>
    </FiniteElements>
    <Instationary>
        <SolveInstationary>1</SolveInstationary>
        <Method>CrankNicolson</Method>
        <Timestep>0.025</Timestep>
        <Endtime>8.0</Endtime>
    </Instationary>
    <Boundary2D>
        <InflowMaterial>15</InflowMaterial>
        <OutflowMaterial>16</OutflowMaterial>
        <CylinderMaterial>14</CylinderMaterial>
    </Boundary2D>
    <Boundary3D>
        <InflowMaterial>10</InflowMaterial>
        <OutflowMaterial>12</OutflowMaterial>
        <CylinderMaterial>13</CylinderMaterial>
    </Boundary3D>
    <NonlinearSolver>
        <UseHiFlowNewton>1</UseHiFlowNewton>
        <MaximumIterations>20</MaximumIterations>
        <AbsoluteTolerance>1.e-15</AbsoluteTolerance>
        <RelativeTolerance>1.e-6</RelativeTolerance>
        <DivergenceLimit>1.e6</DivergenceLimit>
        <ArmijoUpdate>0</ArmijoUpdate>
        <ThetaInitial>1.0</ThetaInitial>
        <ThetaMinimal>1.e-16</ThetaMinimal>
        <ArmijoDecrease>0.5</ArmijoDecrease>
        <SufficientDecrease>1.e-2</SufficientDecrease>
        <MaxArmijoIteration>5</MaxArmijoIteration>    
        <ForcingStrategy>EisenstatWalker1</ForcingStrategy>
        <ConstantForcingTerm>1.e-4</ConstantForcingTerm>
        <InitialValueForcingTerm>1.e-3</InitialValueForcingTerm>
        <MaxValueForcingTerm>1.e-2</MaxValueForcingTerm>
        <GammaParameterEW2>0.9</GammaParameterEW2>
        <AlphaParameterEW2>2</AlphaParameterEW2>
    </NonlinearSolver>
    <LinearSolver>
        <MaximumIterations>1000</MaximumIterations>
        <AbsoluteTolerance>1.e-15</AbsoluteTolerance>
        <RelativeTolerance>1.e-6</RelativeTolerance>
        <DivergenceLimit>1.e6</DivergenceLimit>
        <BasisSize>500</BasisSize>
        <Preconditioning>1</Preconditioning>
    </LinearSolver>
    <Schur>
        <NumIter>50</NumIter>
        <RelativeTolerance>1.e-1</RelativeTolerance>
        <PrintLevel>3</PrintLevel>
        <SolverBlockA>
            <NumIter>1000</NumIter>
            <BasisSize>100</BasisSize>
            <RelativeTolerance>5.e-3</RelativeTolerance>
        </SolverBlockA>
        <PrecondBlockA>
            <MaxLevels>25</MaxLevels>
            <MaxCoarseSize>9</MaxCoarseSize>
            <CycleType>1</CycleType>
            <InterpType>6</InterpType>
            <CoarsenType>10</CoarsenType>
            <RelaxType>3</RelaxType>
            <RelaxWt>0.5</RelaxWt>
            <StrongThreshold>0.6</StrongThreshold>
            <NumSweeps>5</NumSweeps>
            <AggNumLevels>25</AggNumLevels>
            <AggInterpType>4</AggInterpType>
            <Nodal>0</Nodal>
            <SmoothNumLevels>0</SmoothNumLevels>
            <Variant>3</Variant>
            <Overlap>1</Overlap>
            <DomainType>1</DomainType>
            <SchwarzUseNonSymm>1</SchwarzUseNonSymm>
        </PrecondBlockA>
        <SolverPrecond>
            <NumIter>500</NumIter>
            <RelativeTolerance>1.e-1</RelativeTolerance>
        </SolverPrecond>
        <PrecondPrecond>
            <MaxLevels>25</MaxLevels>
            <MaxCoarseSize>9</MaxCoarseSize>
            <CycleType>1</CycleType>
            <RelaxType>6</RelaxType>
            <RelaxWt>0.5</RelaxWt>
            <NumFunctions>1</NumFunctions>
            <InterpType>6</InterpType>
            <CoarsenType>10</CoarsenType>
            <StrongThreshold>0.6</StrongThreshold>
            <NumSweeps>3</NumSweeps>
            <AggNumLevels>25</AggNumLevels>
            <AggInterpType>4</AggInterpType>
            <SmoothNumLevels>0</SmoothNumLevels>
            <Variant>3</Variant>
            <Overlap>1</Overlap>
        </PrecondPrecond>
    </Schur>
    <!--- WARNING: Pressure filter might not be suitable for the current formulation of the problem -->
    <UsePressureFilter>0</UsePressureFilter>
    <Backup>
        <Restore>0</Restore>
        <LastTimeStep>0</LastTimeStep>
        <Filename>backup.h5</Filename>
    </Backup>
</Param>
